openapi: "3.0.1"
info:
  title: "SCALE BaT Basket Service"
  version: v0.01
  description: This API provides access to the Buy a Thing shopping basket functionality. It includes functions to add and remove products from the basket, to save and restore the basket, to manage product wishists, to convert baskets to quotes (and quotes to baskets).
#  PLACEHOLDERs - to be uncommented when implemented
  termsOfService: "http://api.crowncommercial.gov.uk/terms/"
  contact:
    email: "apiteam@crowncommercial.gov.uk"
  license:
    name: "Open Government Licence 3.0"
    url: "https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
#
# TODO:
# 1. Write the API
#
#security:
#  - OAuth2:
#    - read
tags:
- name: "Basket"
  description: "Operations on Active Basket"
  externalDocs:
    description: "Find out more"
    url: "http://apis.crowncommercial.gov.uk"
- name: "Saved Basket"
  description: "Operations on Saved Baskets"
  externalDocs:
    description: "Find out more"
    url: "http://apis.crowncommercial.gov.uk"
- name: "Wishlist"
  description: "Operations on Product wishlists"
  externalDocs:
    description: "Find out more"
    url: "http://apis.crowncommercial.gov.uk"
- name: "Quote"
  description: "Operations on Quotes"
  externalDocs:
    description: "Find out more"
    url: "http://apis.crowncommercial.gov.uk"
paths:
  /baskets/active:
    get:
      summary: Returns the Active Basket.
      description: Returns the contents of the current Basket for the signed in user (products, variants, quantities)
      tags:
      - Basket
      operationId: get-basket
      parameters:
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-correlation-id'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-causation-id'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-channel'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-client'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/BAT_initial/common/CCS_Standard_API_Params.yaml#/components/parameters/DetailParam'
      responses:
        200:
          description: Details of the Current Basket
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Basket'
        500:
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Schema.yaml#/components/schemas/Errors'
                
  /baskets:
    get:
      summary: Returns all Saved Baskets for the user (note not the current basket).
      description: Returns all Saved Baskets for the user (note not the current basket).
      tags:
      - Saved Basket
      operationId: get-saved-basket-list
      parameters:
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-correlation-id'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-causation-id'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-channel'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Params.yaml#/components/parameters/x-client'
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/BAT_initial/common/CCS_Standard_API_Params.yaml#/components/parameters/DetailParam'
      responses:
        200:
          description: Details of the Current Basket
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/SavedBasketSummaries'
                  - $ref: '#/components/schemas/SavedBasketDetails'
        500:
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/CCS_Standard_API_Schema.yaml#/components/schemas/Errors'
                
               
#
components:
#  securitySchemes:
#    OAuth2:
#      type: oauth2
#      flows:
#        authorizationCode:
#          authorizationUrl: http://ccsexample.com/oauth/auth
#          tokenUrl: https://api.crowncommercial.gov.uk/oauth/token
#          scopes:
#            read: Grants read access
#           only read for MVP
  schemas:
#
    Basket:
      allOf:
        - $ref: '#/components/schemas/Order'


  ############## TO BE MOVED TO CENTRAL FILE ############


    Order:
      type: object
      description: Basic object for a basket containing all data for the Active basket.
      properties:
        id:
          $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/BAT_initial/bat/bat-schema.yaml#/components/schemas/OrderID'
          #$ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/BAT_initial/common/CCS_Standard_API_Schema.yaml#/components/schemas/GenericID'
          #$ref: '#/components/schemas/OrderID'
        name:
          type: string

    SavedBasketSummaries:
      type: array
      items:
        $ref: '#/components/schemas/SavedBasketSummary'

    SavedBasketDetails:
      type: array
      items:
        $ref: '#/components/schemas/SavedBasketDetail'

          
    SavedBasketSummary:
      type: object
      properties:
        name:
          type: string
          description: Name given to the basket when it was saved
          example: "Equipment for new starter"
        createdDate:
          type: string
          format: date-time
          example: "2020-12-25T17:32:28Z"
        order:
          $ref: '#/components/schemas/Order'

    SavedBasketDetail:
      type: object
      properties:
        name:
          type: string
          description: Name given to the basket when it was saved
          example: "Equipment for new starter"
        createdDate:
          type: string
          format: date-time
          example: "2020-12-25T17:32:28Z"


          
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/davejhughes/BaT-Basket/v0.01