components:
  schemas:
  
    OrderID:
      type: string
      description: The ID of the order within BaT
      example: R793138650
      readOnly: true
    
    CatalogueID:
      type: number
      format: integer
      example: 1234
      readOnly: true
      
    Catalogue:
      type: object
      description: Metadata about a Catalogue
      required:
        - id
#         - quantity
      properties: 
        id:  
          type: string
          readOnly: true
          format: uuid
          description: 'ID of the stock item'
          example: 222
        agreement:  
          $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/agreements/agreements-service.yaml#/components/schemas/AgreementSummary'
        supplier:  
          $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Organization'

    CatalogueUpdate:
      oneOf:
        - $ref: '#/components/schemas/FileUpdate'
        - $ref: '#/components/schemas/CatalogueRecordUpdate'
          
    CatalogueList:
      type: array
      items:
        $ref: '#/components/schemas/CatalogueID'
             
    FileUpdate:
      type: object
      description: Details of a file Upload
      properties: 
        date:  
          description: 'Time upload took place'
          allOf:
            - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Timestamp'
        myurl:
          type: string
          format: uri
          description: URI for the file. Should be a perma-link and can be used as a key for file uploaded
        name:
          type: string
          description: document name
        fileformat:
          allOf: 
            - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/FileFormat'

    CatalogueRecordUpdate:
      type: object
      description: Details of catalogue update
      properties: 
        date:  
          allOf:
            - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Timestamp'
        before:
          allOf:
            - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Item'
        after:
          allOf:
            - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Item'
        
    ProductID:
      type: number
      format: integer
      example: 1234
      readOnly: true
      
    Product:
      allOf:
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Item'
        
    ProductList:
      type: array
      items:
        $ref: '#/components/schemas/Product'
  
    VariantID:
      type: number
      format: integer
      example: 1234
      readOnly: true
      
    Variant:
      allOf:
        - $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Item'
        - $ref: '#/components/schemas/StockList'
        
    VariantList:
      type: array
      items:
        $ref: '#/components/schemas/Product'
        
    
    StockItem:
      type: object
      description: Items of stock
      required:
        - id
        - quantity
      properties: 
        id:  
          type: string
          readOnly: true
          format: uuid
          description: 'ID of the stock item'
          example: 222
        variant:  
          $ref: '#/components/schemas/VariantID'
        product:  
          $ref: '#/components/schemas/ProductID'
        location:
          type: object
          description: location of the stock
          properties:
            address:
              $ref: 'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Address'
        qantitity:
          type: number
          format: int32
          description: 'Quantity of stock available'
          example: 222
        
    StockList:
      type: array
      items:
        $ref: '#/components/schemas/StockItem'
        
    LineItem:
      allOf:
        # OCDS Item is id, description, classification, additionalClassifications, quantity, unit
        # Classification is scheme, id, description, uri - see https://standard.open-contracting.org/latest/en/schema/codelists/#item-classification-scheme - we will probably use UNSPSC but specific scheme is to be determined. Note that this classification is different to Spree's Taxon.
       - $ref:  'https://raw.githubusercontent.com/Crown-Commercial-Service/ccs-scale-api-definitions/master/common/OCDS_Schema.yaml#/components/schemas/Item'
      # - type: object
         # All of the other properties required for a Marketplace Basket item 